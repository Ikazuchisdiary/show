# スクショウ計算ツール v1 機能分析と v2 実装状況

## 📊 実装状況サマリー

| カテゴリ | v1機能数 | v2実装済 | 実装率 |
|---------|----------|----------|--------|
| コア計算機能 | 25 | 20 | 80% |
| カードシステム | 18 | 15 | 83% |
| 楽曲システム | 12 | 8 | 67% |
| UIコンポーネント | 24 | 17 | 71% |
| データ永続化 | 8 | 2 | 25% |
| ビジュアル | 15 | 13 | 87% |
| **合計** | **102** | **75** | **74%** |

## 🔥 高優先度の未実装機能

### 1. センターキャラクター機能 🎯
- [ ] センターキャラクターのビジュアルハイライト（オレンジ色の枠）
- [ ] センター特性によるアピール値ボーナス計算
  - [ ] キャラクター別ボーナス（例：乙宗梢 400%）
  - [ ] グループ別ボーナス（例：102期生 200%）
- [ ] AP消費減少効果の実装
- [ ] CT（クールタイム）減少効果

### 2. センタースキル機能 ⚡
- [ ] センタースキルレベル選択UI（Lv.1-10）
- [ ] センタースキルパラメータ入力フィールド
- [ ] タイミング別発動システム
  - [ ] `beforeFirstTurn`: ライブ開始時
  - [ ] `beforeFeverStart`: FEVER開始時
  - [ ] `afterLastTurn`: ライブ終了時
- [ ] センタースキル効果の計算への反映

### 3. AP不足計算機能 💰
- [ ] AP収支の詳細表示（収入/支出）
- [ ] AP不足時のカード除外最適化アルゴリズム
- [ ] 除外カードと参考スコアの表示
- [ ] AP獲得の1.5倍補正

### 4. ローカルストレージ機能 💾
- [ ] カードごとのスキルレベル保存
- [ ] センタースキルレベル保存
- [ ] カスタム楽曲リストの永続化
- [ ] 楽曲ごとの編成状態保存
- [ ] ユーザー修正値の保存

## 📋 詳細機能リスト

### ✅ 実装済み機能

#### コア計算機能
- ✅ 基本スコア計算式
- ✅ ターンベース計算システム
- ✅ カードローテーション
- ✅ スコアブースト累積
- ✅ ボルテージレベル計算（20段階 + 追加レベル）
- ✅ フィーバー中のボルテージ2倍
- ✅ メンタルシステム基本実装
- ✅ コンボ数計算
- ✅ 難易度別設定

#### カードシステム
- ✅ 6スロットカード選択
- ✅ 検索可能ドロップダウン
- ✅ スキルレベル選択（Lv.1-14）
- ✅ ドラッグ&ドロップ並び替え
- ✅ スキル効果表示
- ✅ 条件付き効果（conditional）
- ✅ スキルレベル倍率計算
- ✅ スキルパラメータの編集機能
- ✅ ユーザー修正値の管理とハイライト
- ✅ カード番号のドラッグインジケーター（⋮⋮）

#### 楽曲システム
- ✅ 楽曲選択ドロップダウン
- ✅ カスタム楽曲入力
- ✅ フェーズ設定（フィーバー前/中/後）
- ✅ 楽曲属性選択

#### UIコンポーネント
- ✅ スコア計算ボタン
- ✅ 結果表示エリア
- ✅ 共有URL生成
- ✅ ターンログ表示
- ✅ レスポンシブデザイン基本

### ❌ 未実装機能

#### センター関連機能
- ❌ センターキャラクターハイライト表示
- ❌ センター特性効果の計算
- ❌ センタースキルUI
- ❌ センタースキル発動タイミング
- ❌ グループボーナス計算
- ❌ GameSimulatorでのカスタムスキル値使用

#### データ永続化
- ❌ スキルレベルの自動保存/読み込み
- ❌ カスタム楽曲の保存/削除
- ❌ 楽曲別編成保存
- ❌ アップデート通知の既読管理

#### 高度なUI機能
- ❌ アップデートバナー
- ❌ 更新履歴モーダル
- ❌ 重複キャラクター警告
- ❌ モバイルタッチドラッグ
- ❌ ドラッグヒント表示
- ❌ 詳細ログの色分け表示

#### AP関連機能
- ❌ AP収支詳細（展開可能）
- ❌ AP不足最適化計算
- ❌ 参考スコア表示
- ❌ カード除外提案

#### その他の機能
- ❌ fantasyGinカードの特殊入力保存
- ❌ 共有モード表示
- ❌ カスタム楽曲の上書き確認
- ❌ エラーハンドリング強化

## 🎨 ビジュアル要素の実装状況

### ✅ 実装済み
- ✅ 属性色（smile=赤、pure=緑、cool=青）
- ✅ 効果別色分け（positive=緑、negative=赤）
- ✅ ホバーエフェクト
- ✅ ドラッグ時の視覚フィードバック
- ✅ ボタンアニメーション

### ❌ 未実装
- ❌ センターキャラクターのオレンジ色ハイライト
- ❌ 共有モードの背景色変更
- ❌ ユーザー修正値の黄色背景
- ❌ フィーバーフェーズの🔥アイコン
- ❌ ドラッグヒントの表示/非表示

## 📝 実装優先順位

### Phase 1: コア機能の完成（必須）
1. **センターキャラクター機能** - アピール値計算の正確性に必須
2. **センタースキル機能** - ゲーム仕様の完全再現に必須
3. **AP不足計算** - 実用性に必須
4. **ローカルストレージ** - UX向上に必須

### Phase 2: UI/UX改善（重要）
5. **アップデートバナーシステム**
6. **詳細ログの色分け**
7. **重複キャラクター警告**
8. **カスタム楽曲管理UI**

### Phase 3: 追加機能（nice to have）
9. **モバイルタッチ対応**
10. **アニメーション強化**
11. **エラーハンドリング改善**

## 🚀 次のステップ

1. センターキャラクター機能の実装から開始
2. 各機能実装時にv1-referenceのコードを参照
3. 実装完了時にこのドキュメントを更新
4. 全機能実装後に統合テストを実施

---

*最終更新: 2024-07-24*
*v1リファレンス: commit f77bad6*

## 📝 最新の実装内容

### 2024-07-24 カード選択UIの完全改善
- ✅ カード番号にドラッグインジケーター（⋮⋮）を追加
- ✅ スキルパラメータを編集可能に変更
- ✅ ユーザー修正値の黄色背景（#fffbdd）ハイライト
- ✅ カスタムスキル値の状態管理（gameStore）
- ✅ fantasyGinカードの特殊入力対応
- ✅ キャラクターごとのグルーピング維持